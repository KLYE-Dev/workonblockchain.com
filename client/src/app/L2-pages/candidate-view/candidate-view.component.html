<section class = "wob-bg-primary2 py-5 mt-5">
  <div class="container pt-2">
    <div class="row">
      <div class="col-md-12">
        <div class="row" *ngIf="viewBy === 'admin'">
          <div class="col-md-12">
            <button [routerLink]="[routerUrl]"  class = "btn btn-primary float-right">Edit Profile</button>
          </div>
        </div>
        <section class = "border rounded mt-3 py-3 px-5 bg-white">
          <div class="row">
            <div class="col-md-6">
              <app-c-formv-image [image]="candidate_image"></app-c-formv-image>
              <div class="mt-3">
                <span><h3 class="text-capitalize">{{userDoc['first_name']}} {{userDoc['last_name']}}</h3></span>
                <span *ngIf="viewBy === 'admin'">
                  <p><a [routerLink]="['/admin-display-chat']" [queryParams]="{user: user_id , type : userDoc.type}" >Show Chat With Companies</a></p>
                </span>
              </div>
            </div>
            <div class="col-md-6">
              <app-c-formv-right-side-bar
                [referredName]="referred_name"
                [referredLink]="referred_link"
                [detailLink]="detail_link"
                [nationality]="userDoc['nationality']"
                [contactNumber]="userDoc['contact_number']"
                [baseCity]="userDoc['candidate']['base_city']"
                [candidateStatus]="candidate_status"
                [createdDate]="created_date"
                viewBy="admin"
              >
              </app-c-formv-right-side-bar>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <pre>{{userDoc['candidate']['description']}}</pre>
            </div>
          </div>
        </section>

        <!--only for admin starts-->
        <section class = "border rounded mt-4 py-3 px-5 bg-white" *ngIf="viewBy === 'admin'">
          <div class="row">
            <div class="col-md-6">
              <h4> <i class="fas fa-user"></i> Account </h4>
            </div>
          </div>
          <div class="row mt-4">
            <div class = "col-md-6">
              <div class="form-group">
                <label>Email verified:</label>
                <p *ngIf="userDoc['is_verify'] === 1"> Yes </p>
                <p *ngIf="userDoc['is_verify'] === 0"> No </p>
              </div>
            </div>

            <div class = "col-md-6">
              <div class="form-group">
                <label>Account enabled:</label>
                <p *ngIf="userDoc['disable_account'] === false"> Yes
                </p>
                <p *ngIf="userDoc['disable_account'] === true"> No </p>
              </div>
            </div>
            <div class = "col-md-6" *ngIf="userDoc['dissable_account_timestamp']">
              <app-c-formv-date label="Account enabled/disabled timestamp:" [value]="userDoc['dissable_account_timestamp']"></app-c-formv-date>
            </div>
          </div>

          <form #approve_form="ngForm" >
            <div class="row">
              <div class="col-md-12">
                <input type="hidden" name="type"  [ngModel]="userDoc['type']">
                <input type="hidden" name="email"  [ngModel]="userDoc['email']">
                <input type="hidden" name="name"  [ngModel]="userDoc['first_name']">
                <input type="hidden" name="is_verify" [ngModel]="userDoc['is_verify']">
                <input type="hidden" name="id" [ngModel]="_id">
                <!--New code for 23-Nov-2018-->
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group">
                      <label>Change status: </label>
                      <select class="form-control selectpicker" title="Select status" [disabled]="userDoc['is_verify'] === 0 ? true : false" id="status_selector" [(ngModel)]="set_status" (ngModelChange) = "changeStatus($event)" name="set_status">
                        <option *ngFor='let status of set_candidate_status' [value]="status.value" >{{status.name}}</option>
                      </select>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-4" id="sel1-reason-rejected" *ngIf = "(set_status === 'Rejected' || set_status === 'rejected')">
                    <div class="form-group">
                      <label>Reason: </label>
                      <select class="form-control selectpicker" title= "Select reason" [(ngModel)]="status_reason_rejected" name="status_reason_rejected">
                        <option *ngFor='let status of set_candidate_status_rejected' [value]="status.value" selected>{{status.name}}</option>
                      </select>
                      <div class="text-danger" *ngIf = "status_error && !status_reason_rejected">
                        {{status_error}}
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4" id="sel1-reason-deferred" *ngIf = "(set_status === 'Deferred' || set_status === 'deferred')">
                    <div class="form-group">
                      <label>Reason: </label>
                      <select class="form-control selectpicker" title="Select reason" [(ngModel)]="status_reason_deferred" name="status_reason_deferred">
                        <option *ngFor='let status of set_candidate_status_deferred' [value]="status.value" selected>{{status.name}}</option>
                      </select>
                      <div class="text-danger" *ngIf = "status_error && !status_reason_deferred">
                        {{status_error}}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row m-0">
              <div class="col-md-6">
                <div class="form-group">
                  <label class="form-check-label">
                    <input class="form-check-input" type="checkbox" name="add_note" [(ngModel)]="add_note" (click)="refreshSelect()"> Add note
                  </label>
                </div>
              </div>
            </div>
            <div class="row" *ngIf = "add_note === true">
              <div class="col-md-4">
                <div class="form-group">
                  <label>Template</label>
                  <select class="form-control selectpicker" (change)="selectTemplate($event, 'note')" title="(select one)" required name="template" [(ngModel)]="note_template">
                    <option *ngFor='let template of templates'  [value]="template" >{{template}}</option>
                  </select>
                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <ckeditor  [config]="ckeConfig" debounce="500" name="note" [(ngModel)]="note" >
                  </ckeditor>
                </div>
              </div>
            </div>

            <div class="row m-0">
              <div class="col-md-6">
                <div class="form-group">
                  <label class="form-check-label">
                    <input class="form-check-input" type="checkbox" name="send_email" [(ngModel)]="send_email" (click)="refreshSelect()"> Send email
                  </label>
                </div>
              </div>
            </div>
            <div class="row" *ngIf = "send_email === true">
              <div class="col-md-4">
                <div class="form-group">
                  <label>Template</label>
                  <select class="form-control selectpicker" (change)="selectTemplate($event, 'email')" title="(select one)" required name="template" [(ngModel)]="email_template">
                    <option *ngFor='let template of templates'  [value]="template" >{{template}}</option>
                  </select>

                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <label>Subject:</label>
                  <input type="text" class="form-control" [(ngModel)]="email_subject" required  name="email_subject">

                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <ckeditor  [config]="ckeConfig" debounce="500" name="email_text" [(ngModel)]="email_text" >
                  </ckeditor>
                </div>
              </div>
              <div class="col-md-7">
                <p>Make sure the email text is complete and checked before you press Send</p>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12">
                <div class = "form-group">
                  <button type="submit" (click) = "approveClick(approve_form)"  class = "btn btn-primary float-right" *ngIf = "!email_text" >Done</button>
                  <button type="submit" (click) = "approveClick(approve_form)"  class = "btn btn-primary float-right" *ngIf = "email_text" >Send</button>
                </div>
              </div>
              <div class="col-md-12">
                <div class="text-success float-right mt-2" *ngIf = "success">
                  {{success}}
                </div>
                <div class="text-danger float-right mt-2" *ngIf = "error">
                  {{error}}
                </div>
              </div>
            </div>
            <!--/New code for 23-Nov-2018-->
          </form>
        </section>

        <section class = "border rounded mt-4 py-3 px-5 bg-white" *ngIf="viewBy === 'admin' && candidateHistory">
          <div class="row">
            <div class="col-md-12">
              <h2> <i class="fas fa-history"></i> History </h2>
            </div>
          </div>

          <div class="row mt-4" *ngFor="let history of candidateHistory; let i=index">
            <div class="col-md-6">
              <div class="form-group">
                <label >{{history.timestamp | date : 'dd'}} {{history.timestamp | date : 'MMM'}} {{history.timestamp | date : 'yyyy'}} {{history.timestamp | date : 'HH:mm'}}</label>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group" *ngIf="history.status">
                <label *ngIf="history.status.status === 'wizard' || history.status.status === 'wizard completed'" class="border border-success p-2 text-success rounded font-weight-normal">
                  wizard
                </label>
                <label *ngIf="history.status.status === 'approved' || history.status.status === 'created' || history.status.status === 'updated' || history.status.status === 'updated by admin'" class="border border-success p-2 text-success rounded font-weight-normal">
                  {{history.status.status}}
                </label>
                <label *ngIf="history.status.status === 'other'" class="border border-warning p-2 text-warning rounded font-weight-normal">
                  {{history.status.status}}
                </label>
                <label *ngIf="history.status.status === 'reviewed'" class="border border-info p-2 text-info rounded font-weight-normal">
                  {{history.status.status}}
                </label>
                <label *ngIf="history.status.status === 'rejected'" class="border border-danger p-2 text-danger rounded font-weight-normal">
                  {{history.status.status}}: {{history.status.reason}}
                </label>
                <label *ngIf="history.status.status === 'deferred'" class="border border-warning p-2 text-warning rounded font-weight-normal">
                  {{history.status.status}}: {{history.status.reason}}
                </label>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group" *ngIf="history.note">
                <div>
                  <label>Note</label>
                  <app-c-formv-html-area [value]="history.note"></app-c-formv-html-area>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group" *ngIf="history.email_html">
                <label>Email</label>
                <h6>{{history.email_subject}}</h6>
                <app-c-formv-html-area [value]="history.email_html"></app-c-formv-html-area>
              </div>
            </div>

            <div class="col-md-12">
              <hr *ngIf="i < (userDoc['candidate']['history'].length - 1)"  />
            </div>
          </div>
        </section>
        <!--only for admin ends-->
        <!--section for progress bar-->
        <app-i-formv-candidate-progressbar [value]="progress_bar_value" [class]="progress_bar_class" [routerUrl]="routerUrl" [viewBy]="viewBy"></app-i-formv-candidate-progressbar>
        <!--section for progress bar ends-->

        <!--About section starts-->
        <section class = "border rounded mt-4 py-3 px-5 bg-white">
          <div class="row">
            <div class="col-md-12">
              <h2> <i class="fas fa-user"></i> About </h2>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-6 mb-3">
              <app-c-formv-text label="Email address:" [value]="userDoc['email']"></app-c-formv-text>
            </div>
          </div>
          <div class="row mt-3" *ngIf="userDoc['candidate'].github_account || userDoc['candidate'].stackexchange_account || userDoc['candidate'].linkedin_account || userDoc['candidate'].medium_account || userDoc['candidate'].stackoverflow_url || userDoc['candidate'].personal_website_url">
            <div class="col-md-6">
              <h4>Links</h4>
            </div>
          </div>
          <div class="row mt-2" *ngIf="userDoc['candidate'].github_account">
            <div class="col-md-6">
              <div class="form-group" >
                <p class="break-class">
                  <i class="fab fa-github fa-2x"></i><a class="ml-2" [href]="websiteUrl(userDoc['candidate'].github_account)" target="_blank">
                  {{userDoc['candidate'].github_account}}
                </a>
                </p>
              </div>
            </div>
          </div>
          <!--<div class="row mt-2" *ngIf="data.candidate.stackexchange_account">
            <div class="col-md-6">
              <div class="form-group">
                <p class="break-class">
                  <i class="fab fa-stack-exchange fa-2x"></i><a class="ml-2" [href]="websiteUrl(data.candidate.stackexchange_account)" target="_blank">
                  {{data.candidate.stackexchange_account}}
                </a>
                </p>
              </div>
            </div>
          </div>
          <div class="row mt-2" *ngIf="data.candidate.linkedin_account">
            <div class="col-md-6">
              <div class="form-group" >
                <p class="break-class">
                  <i class="fab fa-linkedin-in fa-2x"></i><a class="ml-2" [href]="websiteUrl(data.candidate.linkedin_account)" target="_blank">
                  {{data.candidate.linkedin_account}}
                </a>
                </p>
              </div>
            </div>
          </div>
          <div class="row mt-2" *ngIf="data.candidate.medium_account">
            <div class="col-md-6">
              <div class="form-group" >
                <p class="break-class">
                  <i class="fab fa-medium-m fa-2x"></i><a class="ml-2" [href]="websiteUrl(data.candidate.medium_account)" target="_blank">
                  {{data.candidate.medium_account}}
                </a>
                </p>
              </div>
            </div>
          </div>
          <div class="row mt-2" *ngIf="data.candidate.stackoverflow_url">
            <div class = "col-md-6">
              <div class="form-group">
                <p class="break-class">
                  <i class="fab fa-stack-overflow fa-2x"></i><a class="ml-2" [href]="websiteUrl(data.candidate.stackoverflow_url)" target="_blank">
                  {{data.candidate.stackoverflow_url}}
                </a>
                <p>
              </div>
            </div>
          </div>
          <div class="row mt-2" *ngIf="data.candidate.personal_website_url">
            <div class = "col-md-6">
              <div class="form-group">
                <p class="break-class">
                  <i class="fas fa-user fa-2x"></i><a class="ml-2" [href]="websiteUrl(data.candidate.personal_website_url)" target="_blank">
                  {{data.candidate.personal_website_url}}
                </a>
                <p>
              </div>
            </div>
          </div>-->
        </section>
        <!--About section ends-->
      </div>
    </div>
  </div>
</section>
